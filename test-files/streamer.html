<!DOCTYPE html>
<html>
    <head>
        <script language="javascript" type="text/javascript" src="../bower_components/papaparse/papaparse.min.js"></script>
    </head>
    <body>
        <input type="file" id="files" name="files[]" accept=".csv, .json, .tsv, .txt, .yml, .xml" value="Upload" multiple/>
        <output id="list"></output>

        <script>

            function handleFileSelect(evt) {
                /* want to check out what the event looks like */
                console.log("The event fired by the dom event change");
                console.log(evt);
                var filer = evt.target.files[0];
                var fname = filer['name'].split(".");
                var ext = fname.pop();
                switch (ext) {
                    case "csv":
                    var data = Papa.parse(filer, {
                        skipEmptyLines: true,
                        complete: function(result) {
                            console.log(result);
                        }
                    });
                    break;
                    
                    case "tsv":
                    var data = Papa.parse(filer, {
                        skipEmptyLines: true,
                        delimiter: "\t",
                        complete: function (result) {
                            console.log(result);
                        }
                    });
                    break;
                        
                    case "json":
                    var reader = new FileReader();
                    reader.onload = function (fevent) {
                        var data = JSON.parse(fevent.target.result);
                        console.log(data);
                    };
                    reader.readAsText(filer);
                    break;
                }     
                       
            }
            
            document.getElementById('files').addEventListener('change', handleFileSelect, false);
        </script>
    </body>
</html>
